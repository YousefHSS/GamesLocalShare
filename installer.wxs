<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="Games Local Share" 
           Version="1.0.0.0" 
           Manufacturer="Your Name" 
           UpgradeCode="A1B2C3D4-E5F6-7890-ABCD-EF1234567890"
           Scope="perMachine">
    
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    
    <Media Id="1" Cabinet="GamesLocalShare.cab" EmbedCab="yes" />

    <!-- Install to Program Files -->
    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="GamesLocalShare" />
    </StandardDirectory>

    <!-- Start Menu -->
    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="Games Local Share"/>
    </StandardDirectory>

    <!-- Desktop -->
    <StandardDirectory Id="DesktopFolder" />

    <!-- Main application files -->
    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <Component Id="MainExecutable" Guid="*">
        <File Id="GamesLocalShareExe" 
              Source="bin\Release\net8.0\win-x64\publish\GamesLocalShare.exe" 
              KeyPath="yes">
          <Shortcut Id="StartMenuShortcut" 
                    Directory="ApplicationProgramsFolder" 
                    Name="Games Local Share"
                    WorkingDirectory="INSTALLFOLDER" 
                    Icon="AppIcon.exe" 
                    IconIndex="0" 
                    Advertise="yes" />
          <Shortcut Id="DesktopShortcut" 
                    Directory="DesktopFolder" 
                    Name="Games Local Share"
                    WorkingDirectory="INSTALLFOLDER" 
                    Icon="AppIcon.exe" 
                    IconIndex="0" 
                    Advertise="yes" />
        </File>
        
        <!-- Registry for tracking installation -->
        <RegistryValue Root="HKCU" 
                       Key="Software\GamesLocalShare" 
                       Name="installed" 
                       Type="integer" 
                       Value="1" 
                       KeyPath="no" />
      </Component>
    </ComponentGroup>

    <Icon Id="AppIcon.exe" SourceFile="Icons\app.ico" />

    <Feature Id="ProductFeature" Title="Games Local Share" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
    </Feature>
    
    <!-- Uninstall shortcut -->
    <Component Id="CleanupMainProgramFolder" Directory="ApplicationProgramsFolder" Guid="*">
      <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall" />
      <RegistryValue Root="HKCU" Key="Software\GamesLocalShare" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
    </Component>
  </Package>
</Wix>
